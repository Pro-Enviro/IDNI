<!-- This component is making the links in header unclickable -->
<!--<app-top-page-img-tpl></app-top-page-img-tpl>-->
<section>
  <div class="container">
    <div class="grid">
      <div class="col-12">
        <p-panel *ngIf="!fileContent" header="Select Company" [style]="{width: '60%', margin: 'auto', marginTop:'5rem'}">
          <p-dropdown [options]="companies" optionLabel="name" optionValue="id" [(ngModel)]="selectedCompany" [style]="{ width: '12rem'}"></p-dropdown>
        </p-panel>
      </div>
      <div class="col-12">
        <p-panel header="File Upload" *ngIf="!fileContent" [style]="{width: '60%', margin: 'auto', marginTop:'5rem'}">
          <p-fileUpload name="file[]" [customUpload]="true"
                        (onSelect)="getFileType($event)"
                        (uploadHandler)="onUpload($event)"
                        [multiple]="false"
                        chooseStyleClass="btn-style"
                        cancelStyleClass="btn-dark"
                        uploadStyleClass="btn-outline">
            <ng-template pTemplate="content">
              <ul *ngIf="uploadedFiles.length">
                <li *ngFor="let file of uploadedFiles">{{ file.name }} - {{ file.size }} bytes</li>
              </ul>
            </ng-template>
          </p-fileUpload>
        </p-panel>
        <p-panel *ngIf="isXlsx">
          <p-selectButton [options]="availableSheets" [(ngModel)]="selectedSheet" (click)="getSheetData()" class="btn-select"></p-selectButton>
        </p-panel>
        <ng-container *ngIf="fileContent">
          <p-panel  #table  header="HHD">
            <div class="flex">
              <div class="p-2 border-1 surface-border border-round w-15rem" pDroppable (onDrop)="dropMpan()">
                <p-panel header="MPAN Number">
                  <ul class="list-none flex flex-column gap-2 p-0 m-0" *ngIf="selectedMpan" >
                    <li class="p-2 border-round shadow-1">
                      {{selectedMpan.name}}
                    </li>
                  </ul>
                </p-panel>
              </div>
              <div class="p-2 border-1 surface-border border-round w-15rem" pDroppable (onDrop)="dropStartDate()">
                <p-panel header="Date Column">
                  <ul class="list-none flex flex-column gap-2 p-0 m-0" *ngIf="selectedStartDate" >
                    <li class="p-2 border-round shadow-1">
                      {{selectedStartDate.name}}
                    </li>
                  </ul>
                </p-panel>
              </div>
              <div class="p-2 border-1 surface-border border-round w-15rem" pDroppable (onDrop)="dropFirstData()">
                <p-panel header="Data Start Point">
                  <ul class="list-none flex flex-column gap-2 p-0 m-0" *ngIf="selectedDataStart" >
                    <li class="p-2 border-round shadow-1">
                      {{selectedDataStart.name}}
                    </li>
                  </ul>
                </p-panel>
              </div>
              <div class="p-2 border-1 surface-border border-round w-15rem">
                <p-panel header="Data Type">
                  <ul class="list-none flex flex-column gap-2 p-0 m-0">
                    <li class="">
                      <p-toggleButton [(ngModel)]="reactiveData" onLabel="kVAr" offLabel="kWh" [style]="{ width: '10em', background:'#356c6b',color:'#ffffff'}"></p-toggleButton>
                    </li>
                  </ul>
                </p-panel>
              </div>
            </div>

            <p-table [value]="fileContent.slice(0,10)" [tableStyle]="{ 'min-width': '50rem' }">
              <ng-template pTemplate="body" let-row let-r="rowIndex">
                <tr>
                  <td *ngFor="let cell of row.slice(0,15); index as c">
                    <div pDraggable (onDragStart)="dragStart(cell, r, c)" (onDragEnd)="dragEnd()">{{ cell }}</div>
                  </td>
                </tr>
              </ng-template>
            </p-table>

            <div class="pt-3">
              <button pButton class="btn-style pt-3" icon="pi pi-cog" label="Process" (click)="processData()"></button>
            </div>
          </p-panel>
        </ng-container>
      </div>
    </div>
  </div>
</section>









