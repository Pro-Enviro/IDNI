<div class="col-6">
  <p-card header="Select Company" styleClass="card-select-panel">
    <!--      <p-selectButton [options]="companies" [(ngModel)]="selectedCompany" optionLabel="name" optionValue="id" (ngModelChange)="onSelectCompany()" class="btn-select"></p-selectButton>-->
    <p-dropdown [options]="companies" [(ngModel)]="selectedCompany" optionLabel="name" optionValue="id" (ngModelChange)="onSelectCompany()" [style]="{ width: '12rem'}"></p-dropdown>
  </p-card>
<!--  <p-card styleClass="card-select-panel" *ngIf="role === 'User'">-->
<!--    {{companyName}}-->
<!--  </p-card>-->
</div>

<p-dialog [(visible)]="modelVisible" [modal]="true" [style]="{width: '60vw'}">
  <div class="grid generated-report" style="{padding: 1rem}">
    <div [innerHTML]="docxInHtml" class="col-10"></div>

  </div>
</p-dialog>


 <!--Buttons-->
  <div class="flex justify-content-between">
    <div class="flex justify-content-start">
<!--      <p-dropdown [options]="templateOptions"-->
<!--                  class="mx-5 dropdown-max-height"-->
<!--                  placeholder="Select a template"-->
<!--                  [(ngModel)]="selectedTemplate"-->
<!--                  (onChange)="filterQuestions()"></p-dropdown>-->
    </div>
<!--      <div class="flex justify-content-end">-->
<!--        <button type="submit" icon="pi pi-save" label="Save" pButton class="btn mr-2" (click)="saveForm()"></button>-->
<!--        <button pButton label="Generate Report" (click)="generateReport()" class="btn-dark" icon="pi pi-file-export"></button>-->
<!--      </div>-->
  </div>

<!--  <div class="flex flex-row p-3">-->
<!--      <div class="flex align-items-center justify-content-center ml-3">-->
<!--        <p-checkbox [binary]="true" (onChange)="checkAutoSave($event)"></p-checkbox>-->
<!--        <p class="ml-2">Autosave</p>-->
<!--      </div>-->
<!--    <p class="ml-3">Last saved: <span style="font-weight: 500">{{ timerText }}</span> minute{{ timerText !== '1' ? 's' : '' }} ago</p>-->
<!--  </div>-->

<p-tabView [style]="{width:'75vw', marginBottom: '2rem', paddingBottom: '5rem', minHeight: '75vh'}" (onChange)="sortRecommendations()">

  <!--REPORT DETAILS-->

<!--  <p-tabPanel header="Report details">-->

<!--    &lt;!&ndash;    <p-panel header="Report Details">&ndash;&gt;-->
<!--    <form #f="ngForm" class="w-full flex flex-wrap">-->
<!--      <ng-container *ngFor="let question of questions; index as i">-->
<!--        <div class="col-5" *ngIf="question.section === 'report_details'" style="min-height: 10rem">-->
<!--          <p-card *ngIf="question.section === 'report_details'" header="{{question.question}}"  styleClass="col-12 report-card">-->
<!--            <input pInputTextarea type="text" class="p-inputtext-sm" [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                   [name]="question.answer"-->
<!--                   *ngIf="question.type === 'short'">-->
<!--            <br>-->
<!--            <textarea pInputText [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                      [name]="question.answer"-->
<!--                      *ngIf="question.type === 'long'" rows="5">-->

<!--            </textarea>-->
<!--            <p-calendar-->
<!--              [(ngModel)]="this.reportValues[question.answer_field]" dateFormat="dd/mm/yy" name="date"-->
<!--              [showIcon]="true"-->
<!--              [readonlyInput]="true"-->
<!--              [defaultDate]="this.reportValues[question.answer_field]"-->
<!--              *ngIf="question.type === 'date'"-->
<!--              class="btn-date p-inputtext-sm"-->
<!--            >-->
<!--            </p-calendar>-->
<!--          </p-card>-->
<!--        </div>-->
<!--      </ng-container>-->
<!--    </form>-->
<!--    &lt;!&ndash;    </p-panel>&ndash;&gt;-->
<!--  </p-tabPanel>-->
  <!--COMPANY INFORMATION-->
<!--  <p-tabPanel header="Company Information">-->
<!--    &lt;!&ndash;    <p-panel header="Company Information">&ndash;&gt;-->
<!--    <form #g="ngForm" style="display: flex; flex-wrap: wrap">-->
<!--      <ng-container *ngFor="let question of questions; index as i">-->
<!--        <div class="col-5" *ngIf="question.section === 'company_information'" style="min-height: 10rem">-->
<!--          <p-card *ngIf="question.section === 'company_information'" header="{{question.question}}"  styleClass="report-card">-->
<!--            <input pInputTextarea type="text" [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                   [name]="question.answer"-->
<!--                   class="p-inputtext-sm"-->
<!--                   *ngIf="question.type === 'short'">-->
<!--            <br>-->
<!--            <textarea style="width: 100%" pInputText [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                      [name]="question.answer"-->
<!--                      class="p-inputtext-sm"-->
<!--                      *ngIf="question.type === 'long'" rows="5"></textarea>-->
<!--            <p-selectButton [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                            *ngIf="question.type === 'yes/no'"-->
<!--                            [options]="['Yes','No']" [name]="question.answer"></p-selectButton>-->

<!--            <p-calendar-->
<!--              [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--              dateFormat="dd/mm/yy" name="date"-->
<!--              [showIcon]="true"-->
<!--              [readonlyInput]="true"-->
<!--              [defaultDate]="this.reportValues[question.answer_field]"-->
<!--              *ngIf="question.type === 'date'"-->
<!--              appendTo="body"-->
<!--              class="btn-date p-inputtext-sm"-->
<!--            ></p-calendar>-->
<!--          </p-card>-->
<!--        </div>-->
<!--      </ng-container>-->
<!--    </form>-->
<!--  </p-tabPanel>-->


  <!--SITE INFORMATION-->
<!--  <p-tabPanel header="Site Information">-->
<!--    <form #f="ngForm" class="flex flex-wrap">-->
<!--      <ng-container *ngFor="let question of questions; index as i">-->
<!--      <div class="col-5"  style="min-height: 10rem" *ngIf="question.section === 'site_information'">-->
<!--        <p-card header="{{question.question}}" *ngIf="question.section === 'site_information'" styleClass="report-card">-->
<!--          <input pInputTextarea type="text" [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                 [name]="question.answer"-->
<!--                 class="p-inputtext-sm"-->
<!--                 *ngIf="question.type === 'short'">-->
<!--          <br>-->
<!--          <textarea pInputText-->
<!--                    [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                    [name]="question.answer"-->
<!--                    class="p-inputtext-sm w-full"-->
<!--                    *ngIf="question.type === 'long'" rows="5"-->
<!--          ></textarea>-->
<!--          <p-selectButton [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                          *ngIf="question.type === 'yes/no'"-->
<!--                          [options]="['Yes','No']" [name]="question.answer" class="btn-select"></p-selectButton>-->

<!--        </p-card>-->
<!--      </div>-->
<!--      </ng-container>-->
<!--    </form>-->
<!--  </p-tabPanel>-->


  <!--OBJECTIVES-->
<!--  <p-tabPanel header="Objectives">-->
<!--    <p-panel header="Why These Energy Savings Matter" [style]="{marginTop: '1rem'}">-->
<!--       &lt;!&ndash;<p style="font-weight: 500; margin-bottom: 1rem; text-decoration: underline">Why these energy savings matter</p>&ndash;&gt;-->
<!--        <ng-container *ngFor="let question of questions; index as i">-->
<!--          <div class="mt-3">-->
<!--            <p-card *ngIf="question.section === 'objectives'" header="{{question.question}}" styleClass="col-12 report-card">-->
<!--            <textarea pInputText [(ngModel)]="this.reportValues[question.answer_field]"-->
<!--                      [name]="question.answer"-->
<!--                      class="p-inputtext-sm w-full"-->
<!--                      *ngIf="question.type === 'long'" rows="5"></textarea>-->
<!--            </p-card>-->
<!--          </div>-->
<!--        </ng-container>-->
<!--    </p-panel>-->
<!--  </p-tabPanel>-->


  <!--  Site Assessment-->
<!--  <p-tabPanel header="Site Assessment" >-->
<!--    <ng-container *ngFor="let report of siteAssessmentReport; index as i">-->

<!--      <p-panel-->
<!--        [collapsed]="true"-->
<!--        [toggleable]="true"-->
<!--        toggler="header"-->
<!--        [style]="{marginTop: '1rem'}"-->
<!--      >-->
<!--        <ng-template pTemplate="header">-->
<!--          <div class="flex align-items-center gap-2">-->
<!--            <span class="text-base font-semibold">{{report.question  || 'Select an assessment'}}</span>-->
<!--          </div>-->
<!--        </ng-template>-->

<!--        <div class="flex flex-row">-->
<!--          <div class="col-3">-->
<!--            <div class="h-auto">-->
<!--              <p-card header="Site Assessment Data" styleClass="report-card">-->
<!--                <div class="flex flex-column align-items-start justify-content-center">-->
<!--                  <p-dropdown [options]="siteAssessmentOptions"-->
<!--                              [ngModel]="report"-->
<!--                              scrollHeight="370px"-->
<!--                              appendTo="body"-->
<!--                              optionLabel="question"-->
<!--                              name="question"-->
<!--                              class=" p-inputtext-sm"-->
<!--                              [placeholder]="report.question"-->
<!--                              (onChange)="selectAssessment(i, $event)"></p-dropdown>-->

<!--                  <p-dropdown [(ngModel)]="report.selected_text"-->
<!--                              [options]="['Good', 'Bad']"-->
<!--                              appendTo="body"-->
<!--                              (onChange)="selectGoodOrBad(i, $event)"-->
<!--                              class="mt-3 p-inputtext-sm"-->
<!--                              *ngIf="report.question">-->

<!--                  </p-dropdown>-->

<!--                  <div class="checkbox mt-3">-->
<!--                    <p-checkbox inputId="recoCheck"-->
<!--                                *ngIf="report.question"-->
<!--                                [binary]="true"-->
<!--                                [ngModel]="report.checked"-->
<!--                                (onChange)="handleRecommendationChecked(i, $event, report)">-->

<!--                    </p-checkbox>-->
<!--                    <label for="recoCheck" class="text-sm font-light mt-auto">Add as Recommendation</label>-->
<!--                  </div>-->
<!--                </div>-->
<!--              </p-card>-->
<!--            </div>-->
<!--&lt;!&ndash;            <p-card styleClass="report-card" [style]="{height: 'auto', marginTop: '1rem', display: 'flex', alignItems: 'center', justifyContent: 'center', border: 'none'}" >&ndash;&gt;-->
<!--&lt;!&ndash;              <button label="Delete Assessment" pButton class="btn-dark p-inputtext-sm" icon="pi pi-times"&ndash;&gt;-->
<!--&lt;!&ndash;                      (click)="deleteAssessment(report)"></button>&ndash;&gt;-->
<!--&lt;!&ndash;            </p-card>&ndash;&gt;-->
<!--            <div class="flex justify-content-start pt-5">-->
<!--              <button label="Delete Assessment" pButton class="btn-dark p-inputtext-sm" icon="pi pi-times"-->
<!--                      (click)="deleteAssessment(report)"></button>-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="col-9">-->
<!--            <p-editor label="Default"-->
<!--                      [(ngModel)]="report.answer_field"-->
<!--                      [style]="{minHeight: '100%', height: '300px'}"-->
<!--            >-->
<!--              <ng-template pTemplate="header">-->
<!--                            <span class="ql-formats">-->
<!--                                <div class="toolbar-container">-->
<!--                                <span class="ql-formats">-->
<!--                                  <select class="ql-font"></select>-->
<!--                                  <select class="ql-size"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-bold"></button>-->
<!--                                  <button class="ql-italic"></button>-->
<!--                                  <button class="ql-underline"></button>-->
<!--                                  <button class="ql-strike"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <select class="ql-color"></select>-->
<!--                                  <select class="ql-background"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-script" value="sub"></button>-->
<!--                                  <button class="ql-script" value="super"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-header" value="1"></button>-->
<!--                                  <button class="ql-header" value="2"></button>-->
<!--                                  <button class="ql-blockquote"></button>-->
<!--                                  <button class="ql-code-block"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-list" value="ordered"></button>-->
<!--                                  <button class="ql-list" value="bullet"></button>-->
<!--                                  <button class="ql-indent" value="-1"></button>-->
<!--                                  <button class="ql-indent" value="+1"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-direction" value="rtl"></button>-->
<!--                                  <select class="ql-align"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-link"></button>-->
<!--                                  <button class="ql-image"></button>-->
<!--                                  <button class="ql-video"></button>-->
<!--                                  <button class="ql-formula"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-clean"></button>-->
<!--                                </span>-->
<!--                              </div>-->
<!--                            </span>-->
<!--              </ng-template>-->
<!--            </p-editor>-->
<!--          </div>-->
<!--        </div>-->
<!--      </p-panel>-->
<!--    </ng-container>-->
<!--    <div class="flex justify-content-end">-->
<!--      <button label="Add New Assessment" pButton icon="pi pi-plus" class="btn-dark" (click)="addNewAssessment()"></button>-->
<!--    </div>-->
<!--  </p-tabPanel>-->

  <!--DATA ANALYSIS-->
<!--  <p-tabPanel header="Data Analysis">-->
<!--    <app-data-analysis-->
<!--      *ngIf="selectedCompany"-->
<!--      [selectedCompany]="selectedCompany"-->
<!--      (sendChartDataToParent)="updateChartData($event)"-->
<!--      #dataAnalysis-->
<!--      [savedChartData]="chartData">-->
<!--    </app-data-analysis>-->
<!--  </p-tabPanel>-->


  <!--    Energy Assessment Recommendations - Detail-->
<!--  <p-tabPanel header="Recommendations">-->
<!--    <ng-container *ngFor="let rec of recommendations; index as i">-->
<!--      <p-panel-->
<!--        [collapsed]="true"-->
<!--        [toggleable]="true"-->
<!--        toggler="header"-->
<!--        [style]="{marginTop: '1rem'}"-->
<!--        #reco-->
<!--      >-->
<!--        <ng-template pTemplate="header">-->
<!--          <div class="flex align-items-center gap-2">-->
<!--            <span class="font-semibold" style="font-size: 0.9rem">{{rec.recommendation || 'Add a Recommendation'}}</span>-->
<!--          </div>-->
<!--        </ng-template>-->

<!--        <div class="flex justify-content-end p-2">-->
<!--          <button label="Delete Recommendation" pButton class="btn-dark" icon="pi pi-times"-->
<!--                  (click)="deleteRecommendation(rec)"></button>-->
<!--        </div>-->

<!--        <div class="grid">-->
<!--          <div class="col-8">-->
<!--            <p-card styleClass="report-card mx-2" header="Note">-->
<!--              <p>Omit £ and/or commas when typing numbers.</p>-->
<!--            </p-card>-->
<!--          </div>-->
<!--        </div>-->
<!--        <div class="flex">-->
<!--          <div class="col-6">-->
<!--            <p-card header="Recommendation" styleClass="report-card">-->
<!--              <p-autoComplete-->
<!--                [style]="{'width': '400px'}"-->
<!--                [autoHighlight]="true"-->
<!--                [dropdown]="true"-->
<!--                [ngModel]="rec"-->
<!--                dataKey='recommendation'-->
<!--                [suggestions]="filteredDropdown"-->
<!--                (completeMethod)="filter($event)"-->
<!--                field="question"-->
<!--                [placeholder]="rec.recommendation || 'Add a Recommendation'"-->
<!--                [appendTo]="reco"-->
<!--                (onSelect)="selectedRecommendation($event, i)"-->
<!--                (onBlur)="onBlur($event, i)"-->
<!--                scrollHeight="370px"-->
<!--                class="btn-dropdown p-inputtext-sm"-->
<!--              ></p-autoComplete>-->
<!--            </p-card>-->
<!--          </div>-->
<!--          <div class="col-6">-->
<!--            <p-card header="Add Assessment Text" styleClass="report-card">-->
<!--              <p-dropdown [options]="siteAssessmentReport" appendTo="body" optionLabel="question"-->
<!--                          (onChange)="addAssessmentText($event, rec)" [showClear]="true"-->
<!--                          placeholder="Select an Assessment"-->
<!--                          scrollHeight="370px"-->
<!--              ></p-dropdown>-->
<!--            </p-card>-->
<!--          </div>-->
<!--        </div>-->

<!--        &lt;!&ndash;    FORM FOR RECOMMENDATIONS    &ndash;&gt;-->
<!--        <div class="flex flex-wrap" *ngIf="rec ">-->
<!--          <ng-container *ngFor="let question of questions">-->
<!--            <div class="col-6" *ngIf="question.section ==='recommendations'">-->
<!--              <p-card header="{{question.question}}" *ngIf="question.section === 'recommendations'" styleClass="report-card">-->
<!--                <input pInputTextarea type="text"-->
<!--                       [(ngModel)]="recommendations[i][question.answer_field]"-->
<!--                       [name]="question.answer"-->
<!--                       class="p-inputtext-sm"-->
<!--                       *ngIf="question.type === 'short'"-->
<!--                >-->
<!--                <br>-->
<!--                <textarea  pInputText-->
<!--                          [(ngModel)]="recommendations[i][question.answer_field]"-->
<!--                          [name]="question.answer"-->
<!--                          class="p-inputtext-sm w-full"-->
<!--                          *ngIf="question.type === 'long' " rows="5">-->
<!--                </textarea>-->
<!--                <p-dropdown [(ngModel)]="recommendations[i][question.answer_field]" *ngIf="question.type === 'dropdown'"-->
<!--                            appendTo="body"-->
<!--                            class="p-inputtext-sm"-->
<!--                            scrollHeight="370px"-->
<!--                            [options]="['Behavioural', 'Upgrades', 'Changes to existing technology', 'Replacing with new technology', 'Improvements to building fabric (e.g. Insulation', 'Achieved through resource efficiency', 'Other']"></p-dropdown>-->

<!--                <p-editor *ngIf="question.type === 'editor'" [(ngModel)]="recommendations[i][question.answer_field]"-->
<!--                          class="p-inputtext-sm"-->
<!--                          [style]="{ height: '320px' }">-->
<!--                  <ng-template pTemplate="header">-->
<!--                            <span class="ql-formats">-->
<!--                                <div class="toolbar-container">-->
<!--                                <span class="ql-formats">-->
<!--                                  <select class="ql-font"></select>-->
<!--                                  <select class="ql-size"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-bold"></button>-->
<!--                                  <button class="ql-italic"></button>-->
<!--                                  <button class="ql-underline"></button>-->
<!--                                  <button class="ql-strike"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <select class="ql-color"></select>-->
<!--                                  <select class="ql-background"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-script" value="sub"></button>-->
<!--                                  <button class="ql-script" value="super"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-header" value="1"></button>-->
<!--                                  <button class="ql-header" value="2"></button>-->
<!--                                  <button class="ql-blockquote"></button>-->
<!--                                  <button class="ql-code-block"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-list" value="ordered"></button>-->
<!--                                  <button class="ql-list" value="bullet"></button>-->
<!--                                  <button class="ql-indent" value="-1"></button>-->
<!--                                  <button class="ql-indent" value="+1"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-direction" value="rtl"></button>-->
<!--                                  <select class="ql-align"></select>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-link"></button>-->
<!--                                  <button class="ql-image"></button>-->
<!--                                  <button class="ql-video"></button>-->
<!--                                  <button class="ql-formula"></button>-->
<!--                                </span>-->
<!--                                <span class="ql-formats">-->
<!--                                  <button class="ql-clean"></button>-->
<!--                                </span>-->
<!--                              </div>-->
<!--                            </span>-->
<!--                  </ng-template>-->
<!--                </p-editor>-->
<!--              </p-card>-->
<!--            </div>-->
<!--          </ng-container>-->
<!--        </div>-->

<!--        &lt;!&ndash;    STEPS FOR RECOMMENDATIONS    &ndash;&gt;-->
<!--        <div class="pt-3">-->
<!--          <p-panel header="Steps" >-->
<!--            <div *ngIf="rec">-->
<!--              <ng-container *ngFor="let steps of rec.steps; index as j">-->
<!--                <ng-container *ngFor="let question of questions; index as k">-->
<!--                  <p-card styleClass="report-card col-6"  header="{{question.question}} {{question.question === 'Step' ? j + 1 : ''}}"-->
<!--                          *ngIf="question.section === 'steps'" #steps [style]="{marginTop:'1rem'}">-->
<!--                    <input pInputTextarea type="text"-->
<!--                           [(ngModel)]="recommendations[i].steps[j][question.answer_field]"-->
<!--                           [name]="question.answer"-->
<!--                           class="p-inputtext-sm"-->
<!--                           *ngIf="question.type === 'short'">-->
<!--                    <br>-->
<!--                    <textarea pInputText-->
<!--                              [(ngModel)]="recommendations[i].steps[j][question.answer_field]"-->
<!--                              [name]="question.answer"-->
<!--                              class="p-inputtext-sm w-full"-->
<!--                              *ngIf="question.type === 'long'" rows="5"></textarea>-->

<!--                    <p-calendar-->
<!--                      [(ngModel)]="recommendations[i].steps[j][question.answer_field]"-->
<!--                      dateFormat="mm/yy" name="date"-->
<!--                      [showIcon]="true"-->
<!--                      [readonlyInput]="true"-->
<!--                      [defaultDate]="recommendations[i].steps[j][question.answer_field]"-->
<!--                      *ngIf="question.type === 'date'"-->
<!--                      [appendTo]="steps"-->
<!--                      [minDate]="question.answer_field === 'completionDate' ? recommendations[i].steps[j].startDate : null"-->
<!--                      class="btn-date p-inputtext-sm"-->
<!--                    >-->
<!--                    </p-calendar>-->
<!--                  </p-card>-->
<!--                </ng-container>-->
<!--                <div class="flex justify-content-end">-->
<!--                  <button pButton label="Delete Step" class="btn-dark mt-4" icon="pi pi-times" (click)="deleteStep(i, j)"></button>-->
<!--                </div>-->
<!--                <p-divider></p-divider>-->
<!--              </ng-container>-->
<!--            </div>-->
<!--          </p-panel>-->
<!--        </div>-->
<!--        <button icon="pi pi-plus" label="Add New Step" pButton class="btn" (click)="addNewStep(i)"></button>-->
<!--      </p-panel>-->
<!--    </ng-container>-->
<!--    <div class="flex justify-content-end">-->
<!--      <button label="Add New Recommendation" pButton icon="pi pi-plus" class="btn-dark" (click)="addNewRecommendation()"></button>-->
<!--    </div>-->
<!--  </p-tabPanel>-->

  <!--RECOMMENDATIONS-->
  <p-tabPanel header="Recommendation Summary">
  <p-table [value]="recommendations" styleClass="p-datatable-sm scrollfix reco-table" [style]="{marginTop: '1rem', fontSize: '0.8rem'}">
      <ng-template pTemplate="header">
        <tr>
          <th>No.</th>
          <th [style]="{width: '350px', fontSize: '0.8rem'}">Recommendation</th>
          <th [style]="{width: '200px', fontSize: '0.8rem'}">Type of Change</th>
          <th [style]="{width: '100px', fontSize: '0.8rem'}">Estimated Annual energy saving (kWh/yr)</th>
          <th [style]="{width: '100px', fontSize: '0.8rem'}">Estimated Annual saving (£ exc VAT/yr)</th>
          <th [style]="{width: '100px', fontSize: '0.8rem'}">Estimated cost to implement (£ excl. VAT)</th>
          <th [style]="{width: '100px', fontSize: '0.8rem'}">Payback Period</th>
          <th [style]="{width: '100px', fontSize: '0.8rem'}">Estimated Annual carbon saving
            (tCo2e/yr)
          </th>
          <th [style]="{width:'150px'}">Margin Of Error %</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rec let-i="rowIndex">
        <tr>
          <td>{{ i + 1 }}</td>
          <td>
<!--            <p>{{ rec.recommendationTitle }}</p>-->
            <textarea rows="2" cols="30" pInputTextarea [(ngModel)]="rec.recommendation" style="resize: none" class="p-inputtext-sm w-full mr-2"></textarea>
          </td>

          <td>
            <p-dropdown [options]="changeOptions" class="p-inputtext-sm" [style]="{width: '180px'}" [(ngModel)]="rec.changeType" appendTo="body"></p-dropdown>
          </td>
          <td>
            <p-inputNumber [inputStyle]="{'width':'100px'}" class="p-inputtext-sm"
                           [(ngModel)]="rec.estimatedEnergySaving"></p-inputNumber>
          </td>
          <td>
            <p-inputNumber [inputStyle]="{'width':'100px'}" class="p-inputtext-sm"
                           [(ngModel)]="rec.estimatedSaving"></p-inputNumber>
          </td>
          <td>
            <p-inputNumber [inputStyle]="{'width':'100px'}" [(ngModel)]="rec.estimatedCost" class="p-inputtext-sm"></p-inputNumber>
          </td>
          <td>
            <p-inputNumber [inputStyle]="{'width':'100px'}" [(ngModel)]="rec.paybackPeriod" class="p-inputtext-sm"></p-inputNumber>
          </td>
          <td>
            <p-inputNumber [inputStyle]="{'width':'100px'}"
                           [(ngModel)]="rec.estimatedCarbonSaving" class="p-inputtext-sm"></p-inputNumber>
          </td>
          <td>
            <p-dropdown [options]="percentOptions" class="p-inputtext-sm" [(ngModel)]="rec.marginOfErrorSavings" appendTo="body"></p-dropdown>
          </td>
          <td>
            <button pButton class="p-button-rounded p-button-danger p-button-outlined" icon="pi pi-trash"
                    (click)="deleteRecommendation(rec)"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <tr>
          <td></td>
          <td>Totals</td>
          <td>{{ getTotal('estimatedEnergySaving') }} kWh/ yr</td>
          <td>£ {{ getTotal('estimatedSaving').toFixed(2) }}</td>
          <td>£ {{ getTotal('estimatedCost').toFixed(2) }}</td>
          <td></td>
          <td>{{ getTotal('estimatedCarbonSaving').toFixed(2) }}</td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td><button label="Add New Recommendation" pButton class="p-button p-button-outlined btn btn-dark w-full mr-2" icon="pi pi-plus" (click)="addNewRecommendation()"></button></td>
          <td colspan="8"></td>
        </tr>

      </ng-template>
    </p-table>

<!--    <div class="mt-5">-->
<!--      <p class="font-semibold">{{ reportValues?.businessName }} could achieve annual financial savings of-->
<!--        £{{ getTotal('estimatedSaving').toFixed(2) }}-->
<!--        and {{ getTotal('estimatedCarbonSaving').toFixed(2) }} tonnes of Co2e by implementing the recommendations-->
<!--        within-->
<!--        this report.</p>-->
<!--    </div>-->
  </p-tabPanel>

  <div class="flex justify-content-start pt-4 pl-2">
    <button type="submit" icon="pi pi-save" label="Save" pButton class="btn" (click)="saveForm()"></button>
  </div>
</p-tabView>



